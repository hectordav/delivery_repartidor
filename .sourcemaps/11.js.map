{"version":3,"sources":["../../src/pages/pedido-descripcion-modal/pedido-descripcion-modal.module.ts","../../src/pages/pedido-descripcion-modal/pedido-descripcion-modal.ts"],"names":[],"mappings":"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","file":"11.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { PedidoDescripcionModalPage } from './pedido-descripcion-modal';\n\n@NgModule({\n  declarations: [\n    PedidoDescripcionModalPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(PedidoDescripcionModalPage),\n  ],\n})\nexport class PedidoDescripcionModalPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/pedido-descripcion-modal/pedido-descripcion-modal.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams,ViewController } from 'ionic-angular';\nimport {PrpedidosProvider} from \"../../providers/prpedidos/prpedidos\";\nimport {PrloginProvider} from \"../../providers/prlogin/prlogin\";\nimport {PrmensajeProvider} from \"../../providers/prmensaje/prmensaje\";\n\n@IonicPage()\n@Component({\n  selector: 'page-pedido-descripcion-modal',\n  templateUrl: 'pedido-descripcion-modal.html',\n})\nexport class PedidoDescripcionModalPage {\n\tresult_buscar_pedido:any={\n\t\tid_pedido:'',\n\t\tid_establecimiento:'',\n\t\tnombre_establecimiento:'',\n\t\tnombre_usuario:'',\n\t\ttoken_usuario:'',\n\t\tdireccion_entrega:'',\n\t\tdetalles_direccion_entrega:'',\n\t\tlat_lng_direccion_entrega:'',\n\t\tdireccion_establecimiento:'',\n\t\tdetalles_direccion_establecimiento:'',\n\t\tlat_lng_establecimiento:'',\n\t\thora_entrega:''\n\t};\n\tpublic remainingTime = 20;\n\tresult_pedido_aceptado:any;\n\tresult_pedido:any;\n  result_ignorar_pedido:any;\n  result_enviar_mensaje_cliente:any;\n  result_enviar_mensaje_repartidor:any;\n  id_usuario:any;\n\n  constructor(public navCtrl: NavController, public navParams: NavParams,public viewCtrl: ViewController, public pr_pedido:PrpedidosProvider,public pr_login: PrloginProvider,public pr_mensaje:PrmensajeProvider) {\n  }\n\n  ionViewDidLoad() {\n    console.log('ionViewDidLoad PedidoDescripcionModalPage');\n    this.get_pedido_det_pedido();\n    this.cuenta_regresiva();\n  }\n  cuenta_regresiva(){\n    let interval = setInterval(() => {\n      this.remainingTime--;\n      // if time is over\n      if (this.remainingTime == 0) {\n        // stop interval\n        clearInterval(interval)\n        this.viewCtrl.dismiss();\n      }\n    }, 1000);\n  }\n  ignorar_pedido(){\n    let result_login=this.pr_login.get_inicio_sesion();\n    let _id_usuario;\n     for(let value of result_login) {\n    _id_usuario=value.id_usuario;\n    this.id_usuario=_id_usuario;\n    }\n    let _id_entrega_pedido=this.result_buscar_pedido.id_entrega_pedido;\n    this.pr_pedido.ignorar_pedido(_id_usuario,_id_entrega_pedido).subscribe(\n        pr_pedido => {\n          this.result_ignorar_pedido=pr_pedido;\n           console.log(\"REGISTRO EXISTE\");\n            this.viewCtrl.dismiss();\n        },\n        err => {console.log(\"NO EXISTE REGISTRO\");\n        },\n      );\n  }\n \tget_pedido_det_pedido(){\n  \tlet _pedido=this.pr_pedido.get_result_buscar_pedido();\n     for(let value of _pedido) {\n      this.result_buscar_pedido.id_pedido=value.id_pedido;\n      this.result_buscar_pedido.id_entrega_pedido=value.id_entrega_pedido\n      this.result_buscar_pedido.id_establecimiento=value.id_establecimiento;\n      this.result_buscar_pedido.nombre_establecimiento=value.nombre_establecimiento;\n      this.result_buscar_pedido.nombre_usuario=value.nombre_usuario;\n      this.result_buscar_pedido.token_usuario=value.token_usuario;\n      this.result_buscar_pedido.direccion_entrega=value.direccion_entrega;\n      this.result_buscar_pedido.detalles_direccion_entrega=value.detalles_direccion_entrega;\n      this.result_buscar_pedido.lat_lng_direccion_entrega=value.lat_lng_direccion_entrega;\n      this.result_buscar_pedido.direccion_establecimiento=value.direccion_establecimiento;\n      this.result_buscar_pedido.detalles_direccion_establecimiento=value.detalles_direccion_establecimiento;\n      this.result_buscar_pedido.lat_lng_establecimiento=value.lat_lng_establecimiento;\n      this.result_buscar_pedido.hora_entrega=value.hora_entrega;\n    }\n    console.log(this.result_buscar_pedido);\n  }\n  aceptar_pedido(){\n\t\tlet result_login=this.pr_login.get_inicio_sesion();\n\t\tlet _id_usuario=18;\n\t\t/* for(let value of result_login) {\n\t\tid_usuario=value.id_usuario;\n\t\tthis.id_usuario=id_usuario;\n\t\t}*/\n    let _id_entrega_pedido=this.result_buscar_pedido.id_entrega_pedido;\n  \tlet _id_pedido=this.result_buscar_pedido.id_pedido;\n  \t  this.pr_pedido.buscar_pedido_aceptado(_id_pedido).subscribe(\n  \t     pr_pedido => {\n  \t       this.result_pedido_aceptado=pr_pedido;\n  \t        if(this.result_pedido_aceptado=='existe') {\n  \t        \tthis.pr_pedido.set_pedido_aceptado(1);\n  \t        \t this.viewCtrl.dismiss(true);\n  \t        }else{\n  \t        \tthis.pr_pedido.set_pedido_aceptado(0);\n  \t        \t this.pr_pedido.aceptar_pedido(_id_entrega_pedido,_id_usuario).subscribe(\n  \t        \t    pr_pedido => {\n  \t        \t      this.result_pedido=pr_pedido;\n  \t        \t       console.log(\"REGISTRO EXISTE\");\n                     this.mensaje_cliente_establecimiento();\n  \t        \t    },\n  \t        \t    err => {console.log(\"NO EXISTE REGISTRO\");\n  \t        \t    },\n  \t        \t  );\n  \t        }\n  \t     },\n  \t     err => {console.log(\"NO EXISTE REGISTRO\");\n  \t     },\n  \t   );\n  }\n  mensaje_cliente_establecimiento(){\n    let _token_usuario= this.result_buscar_pedido.token_usuario;\n    let _id_pedido=this.result_buscar_pedido.id_pedido;\n    let _id_establecimiento=this.result_buscar_pedido.id_establecimiento;\n    /*resta los 10 min para enviarle un recordatorio al repartidor*/\n    let _hora_entrega_split=this.result_buscar_pedido.hora_entrega.split('-');\n    let _hora_fin=_hora_entrega_split['1'];\n    let _hora_split=_hora_fin.split(':');\n    let _hora=_hora_split['0'];\n    let _min=_hora_split['1'];\n    if(_min=='00'){\n      _min='50';\n      _hora=_hora-1;\n    }else{\n      _min=_min-10;\n    }\n    let _hora_min=_hora+':'+_min;\n    console.log(_hora_min);\n    /***************************************************************/\n    /* toma el token del repartidor*/\n    let result_login=this.pr_login.get_inicio_sesion();\n    let _id_usuario=18;\n    let _token_repartidor;\n     for(let value of result_login) {\n    _id_usuario=value.id_usuario;\n    _token_repartidor=value.token;\n    }\n    /***************************************************************/\n    let _establecimiento=this.result_buscar_pedido.nombre_establecimiento;\n    let _mensaje_1='Su Pedido, fue asiganado a un repartidor, haga clic en el mismo para mas detalles';\n    let _mensaje_2='Le recordamos que tiene un pedido pendiente en el establecimiento '+_establecimiento+', Ignore este mensaje si ya buscó su pedido';\n     this.pr_mensaje.enviar_mensaje_cliente(_token_usuario,_id_pedido,_mensaje_1).subscribe(\n       pr_mensaje => {\n         this.result_enviar_mensaje_cliente=pr_mensaje;\n          console.log(\"se envio el mensaje al cliente\");\n       },\n       err => {console.log(\"NO EXISTE REGISTRO\");\n       },\n     );\n     this.pr_mensaje.enviar_mensaje_establecimiento(_id_establecimiento,_id_pedido,_mensaje_1).subscribe(\n       pr_mensaje => {\n         this.result_enviar_mensaje_repartidor=pr_mensaje;\n          console.log(\"se envio el mensaje al establecimiento\");\n          this.viewCtrl.dismiss(true);\n       },\n       err => {console.log(\"NO EXISTE REGISTRO\");\n       },\n     );\n\n     /*aqui envia el mensaje al repartidor con unos minutos antes*/\n     this.pr_mensaje.enviar_mensaje_repartidor_min_antes(_hora_min,_token_repartidor,_mensaje_2).subscribe(\n       pr_mensaje => {\n         this.result_enviar_mensaje_repartidor=pr_mensaje;\n          console.log(\"se envio el mensaje al establecimiento\");\n          this.viewCtrl.dismiss(true);\n       },\n       err => {console.log(\"NO EXISTE REGISTRO\");\n       },\n     );\n\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/pedido-descripcion-modal/pedido-descripcion-modal.ts"],"sourceRoot":""}